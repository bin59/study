<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        *{
            margin: 0;
            padding: 0;
            list-style: none;
        }
        ul{
            width: 90%;
            background-color: rgb(253, 239, 214);
            margin: 0 auto;
            padding: 5px;
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
        }
        li{
            width: 384px;
            height: 216px;
            background-color: whitesmoke;
            margin: 5px;
        }
        img{
            display: block;
            width: 100%;
            height: 100%;
        }
    </style>
</head>
<body>
    <div class="imgBox">
        <ul>
            <li><img src="" alt="" lazyLoad="true" data-src="./img/img1.jpg"></li>
            <li><img src="" alt="" lazyLoad="true" data-src="./img/img2.jpg"></li>
            <li><img src="" alt="" lazyLoad="true" data-src="./img/img3.jpg"></li>
            <li><img src="" alt="" lazyLoad="true" data-src="./img/img4.jpg"></li>
            <li><img src="" alt="" lazyLoad="true" data-src="./img/img5.jpg"></li>
            <li><img src="" alt="" lazyLoad="true" data-src="./img/img6.jpg"></li>
            <li><img src="" alt="" lazyLoad="true" data-src="./img/img7.jpg"></li>
            <li><img src="" alt="" lazyLoad="true" data-src="./img/img8.jpg"></li>
            <li><img src="" alt="" lazyLoad="true" data-src="./img/img9.jpg"></li>
            <li><img src="" alt="" lazyLoad="true" data-src="./img/img10.jpg"></li>
            <li><img src="" alt="" lazyLoad="true" data-src="./img/img11.jpg"></li>
            <li><img src="" alt="" lazyLoad="true" data-src="./img/img12.jpg"></li>
            <li><img src="" alt="" lazyLoad="true" data-src="./img/img13.jpg"></li>
            <li><img src="" alt="" lazyLoad="true" data-src="./img/img14.jpg"></li>
            <li><img src="" alt="" lazyLoad="true" data-src="./img/img15.jpg"></li>
            <li><img src="" alt="" lazyLoad="true" data-src="./img/img16.jpg"></li>
            <li><img src="" alt="" lazyLoad="true" data-src="./img/img17.jpg"></li>
            <li><img src="" alt="" lazyLoad="true" data-src="./img/img18.jpg"></li>
            <li><img src="" alt="" lazyLoad="true" data-src="./img/img19.jpg"></li>
            <li><img src="" alt="" lazyLoad="true" data-src="./img/img20.jpg"></li>
            <li><img src="" alt="" lazyLoad="true" data-src="./img/img21.jpg"></li>  
        </ul>
    </div>
    <!-- (li>img[src=""][lazyLoad="true"][data-src="./img/img$.jpg"])*21 -->
    <!-- 
        图片懒加载(图片延迟加载，优化网页性能)
        1、提升用户的体验
        2、减少无效资源的加载(减小服务器的压力)
        3、防止并发加载的资源过多会阻塞js的加载(影响网站的正常使用)
        
        图片懒加载实现原理
        1、利用自定义属性data-, src属性值为空
        2、监听scroll事件，判断用户是否进入图片的可视区域(当前浏览器屏幕)
        3、进入图片的可视区域，自定义属性data-里面的值，赋值给src
     -->
    <script>
        lazyloadFn()
        
        function lazyloadFn(){
            // 获取携带lazyload属性的img标签
            let imgs = document.querySelectorAll(".imgBox ul li img")
            // 获取文档的scrollTop
            let domScrollTop = document.documentElement.scrollTop
            // console.log(domScrollTop)
            imgs.forEach(val=>{
                // console.log(val.offsetTop)
                // 屏幕高度+文档的scrollTop大于等于每张图片的offsetTop，就显示对应图片
                if(window.innerHeight+domScrollTop>=val.offsetTop 
                && val.getAttribute("lazyload")){
                    // 图片的data-src赋值给s rc属性(到达图片可视范围)
                    val.setAttribute("src",val.getAttribute("data-src"))
                    // 移除图片中的lazyload属性(作用是判断图片src是否已经赋值)
                    val.removeAttribute("lazyload")
                    // console.log(val);
                }
            })
        }
       
        document.addEventListener("scroll",e=>{
            lazyloadFn()

        })
    </script>
</body>
</html>